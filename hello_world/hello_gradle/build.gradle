/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

// ------------------- plugin --------------------------
class GreetingPluginExtension {
    String message = 'haha'
}
class GreetingPlugin implements Plugin<Project> {
    void apply(Project project) {
        def extension = project.extensions.create('greeting', GreetingPluginExtension)
        project.task('greeting') {
            group "test"
            doLast {
                println 'Hello from the GreetingPlugin:'+extension.message
            }
        }
    }
}

plugins {
    // 导入自带的 java 和 application plugin
    id "java"
    id "application"
    // 导入 repositories 中的 plugin
    // id "com.sunway.test" version "1.2"
}

// 导入自定义 plugin
apply plugin: GreetingPlugin

greeting {
    message="hi"
}
// ------------------------------------

task hello {
    // Task 同时有 group 属性和 group 方法
    group "test"
    group="test"
    // Task 同时有 dependsOn 属性和 dependsOn 方法, 但 dependsOn 属性是 Iteratable
    // 可以直接 dependsOn="world" 会报错
    dependsOn "world"
    doLast {
        // 打印 Task 的各种属性, 也是通过 delegate
        println dependsOn
        println group
        println path
    }
}

task world {
    group "test"
    doLast {
        println dependsOn
        println group
        println path
    }
}

defaultTasks "world","hello"
